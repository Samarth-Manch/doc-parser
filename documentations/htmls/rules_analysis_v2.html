<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manch Rules Analysis V2 - Based on Real Implementation Data</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            --bg-light: #f1f5f9;
            --bg-card: #ffffff;
            --border: #e2e8f0;
            --text: #1e293b;
            --text-muted: #64748b;
            --code-bg: #1e293b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-light);
            color: var(--text);
            line-height: 1.6;
        }

        .container { max-width: 1600px; margin: 0 auto; padding: 20px; }

        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 50px 30px;
            text-align: center;
            margin-bottom: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.3);
        }

        header h1 { font-size: 2.5rem; margin-bottom: 10px; font-weight: 700; }
        header p { font-size: 1.2rem; opacity: 0.9; }
        header .subtitle { font-size: 1rem; opacity: 0.7; margin-top: 10px; }

        .section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
        }

        .section h2 {
            color: var(--primary);
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section h3 { color: var(--text); font-size: 1.2rem; margin: 25px 0 15px 0; }
        .section h4 { color: var(--secondary); font-size: 1rem; margin: 20px 0 10px 0; font-weight: 600; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8fafc, #f1f5f9);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            border: 1px solid var(--border);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            line-height: 1;
        }

        .stat-label { color: var(--text-muted); font-size: 0.9rem; margin-top: 8px; }

        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 25px; }
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }

        .card {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
        }

        .icon-primary { background: #e0e7ff; color: var(--primary); }
        .icon-success { background: #d1fae5; color: var(--success); }
        .icon-warning { background: #fef3c7; color: var(--warning); }
        .icon-danger { background: #fee2e2; color: var(--danger); }
        .icon-info { background: #cffafe; color: var(--info); }

        code {
            background: var(--code-bg);
            color: #e2e8f0;
            padding: 3px 8px;
            border-radius: 6px;
            font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
            font-size: 0.85em;
        }

        pre {
            background: var(--code-bg);
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            overflow-x: auto;
            font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            margin: 15px 0;
        }

        pre .comment { color: #6b7280; }
        pre .keyword { color: #f472b6; }
        pre .string { color: #86efac; }
        pre .function { color: #fbbf24; }
        pre .number { color: #93c5fd; }
        pre .var { color: #c4b5fd; }

        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { padding: 14px 16px; text-align: left; border: 1px solid var(--border); }
        th { background: var(--bg-light); font-weight: 600; color: var(--text); }
        tr:hover { background: #f8fafc; }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-primary { background: #e0e7ff; color: var(--primary); }
        .badge-success { background: #d1fae5; color: var(--success); }
        .badge-warning { background: #fef3c7; color: var(--warning); }
        .badge-danger { background: #fee2e2; color: var(--danger); }
        .badge-info { background: #cffafe; color: var(--info); }

        .rule-example {
            background: #f8fafc;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
        }

        .rule-example-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border);
        }

        .rule-example-title { font-weight: 600; color: var(--primary); }

        .func-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
            margin: 15px 0;
        }

        .func-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .func-name { font-family: monospace; font-weight: 600; color: var(--primary); }
        .func-count { background: var(--bg-light); padding: 4px 10px; border-radius: 12px; font-size: 0.85rem; }

        .highlight-box {
            background: linear-gradient(135deg, #e0e7ff, #f3e8ff);
            border-left: 5px solid var(--primary);
            padding: 25px;
            border-radius: 0 12px 12px 0;
            margin: 25px 0;
        }

        .highlight-box h4 { margin-top: 0; color: var(--primary-dark); font-size: 1.1rem; }

        .comparison-table { margin: 20px 0; }
        .comparison-table th { background: var(--primary); color: white; }

        .flow-container {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 20px;
            padding: 30px;
            background: var(--bg-light);
            border-radius: 12px;
            margin: 20px 0;
        }

        .flow-step {
            background: white;
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 20px 25px;
            text-align: center;
            min-width: 160px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .flow-step .step-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .flow-step .step-title { font-weight: 600; color: var(--primary); }
        .flow-step .step-desc { font-size: 0.85rem; color: var(--text-muted); margin-top: 5px; }
        .flow-arrow { font-size: 2rem; color: var(--primary); }

        .tag-list { display: flex; flex-wrap: wrap; gap: 8px; margin: 10px 0; }

        .progress-bar {
            background: #e2e8f0;
            border-radius: 10px;
            height: 24px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            font-size: 0.8rem;
            font-weight: 600;
            color: white;
        }

        .checklist { list-style: none; margin: 15px 0; }
        .checklist li {
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .checklist li:last-child { border-bottom: none; }

        @media (max-width: 768px) {
            header h1 { font-size: 1.8rem; }
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .flow-container { flex-direction: column; }
            .flow-arrow { transform: rotate(90deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üî¨ Manch Rules Analysis V2</h1>
            <p>Real Implementation Data Analysis</p>
            <div class="subtitle">Based on 979 rules across 5 production JSON schemas</div>
        </header>

        <!-- Key Findings -->
        <div class="section">
            <h2>üìä Key Findings from Production Data</h2>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">979</div>
                    <div class="stat-label">Total Rules Analyzed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">917</div>
                    <div class="stat-label">Form Fields</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">32</div>
                    <div class="stat-label">Unique Rule Types</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">128</div>
                    <div class="stat-label">Expression Rules</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">58%</div>
                    <div class="stat-label">Client-Side Rules</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">18</div>
                    <div class="stat-label">Expression Functions</div>
                </div>
            </div>

            <div class="highlight-box">
                <h4>üéØ Critical Discovery: Expression Rules are the Key</h4>
                <p>The <strong>EXECUTE</strong> action type with expression-based rules is the most versatile and commonly used for complex business logic.
                These expressions use a JavaScript-like syntax with custom functions like <code>vo()</code>, <code>mvi()</code>, <code>minvi()</code>, <code>mm()</code>, <code>ctfd()</code>, etc.</p>
                <p style="margin-top: 10px;">Converting natural language to these expressions is the primary challenge for automation.</p>
            </div>
        </div>

        <!-- Rule Distribution -->
        <div class="section">
            <h2>üìà Rule Type Distribution</h2>

            <h3>Top 15 Rule Actions (by frequency)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Action Type</th>
                        <th>Count</th>
                        <th>%</th>
                        <th>Processing</th>
                        <th>Category</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>EXECUTE</code></td>
                        <td><strong>128</strong></td>
                        <td>13.1%</td>
                        <td><span class="badge badge-info">CLIENT</span></td>
                        <td><span class="badge badge-primary">Expression</span></td>
                    </tr>
                    <tr>
                        <td><code>COPY_TO</code></td>
                        <td><strong>100</strong></td>
                        <td>10.2%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-success">Data Copy</span></td>
                    </tr>
                    <tr>
                        <td><code>MAKE_INVISIBLE</code></td>
                        <td><strong>83</strong></td>
                        <td>8.5%</td>
                        <td><span class="badge badge-info">CLIENT</span></td>
                        <td><span class="badge badge-danger">Visibility</span></td>
                    </tr>
                    <tr>
                        <td><code>COPY_TO_DOCUMENT_STORAGE_ID</code></td>
                        <td><strong>80</strong></td>
                        <td>8.2%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-success">Data Copy</span></td>
                    </tr>
                    <tr>
                        <td><code>MAKE_MANDATORY</code></td>
                        <td><strong>62</strong></td>
                        <td>6.3%</td>
                        <td><span class="badge badge-info">CLIENT</span></td>
                        <td><span class="badge badge-warning">Validation</span></td>
                    </tr>
                    <tr>
                        <td><code>MAKE_NON_MANDATORY</code></td>
                        <td><strong>62</strong></td>
                        <td>6.3%</td>
                        <td><span class="badge badge-info">CLIENT</span></td>
                        <td><span class="badge badge-warning">Validation</span></td>
                    </tr>
                    <tr>
                        <td><code>EXT_DROP_DOWN</code></td>
                        <td><strong>58</strong></td>
                        <td>5.9%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-info">Lookup</span></td>
                    </tr>
                    <tr>
                        <td><code>MAKE_VISIBLE</code></td>
                        <td><strong>54</strong></td>
                        <td>5.5%</td>
                        <td><span class="badge badge-info">CLIENT</span></td>
                        <td><span class="badge badge-danger">Visibility</span></td>
                    </tr>
                    <tr>
                        <td><code>OCR</code></td>
                        <td><strong>54</strong></td>
                        <td>5.5%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-primary">Extraction</span></td>
                    </tr>
                    <tr>
                        <td><code>VERIFY</code></td>
                        <td><strong>54</strong></td>
                        <td>5.5%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-warning">Validation</span></td>
                    </tr>
                    <tr>
                        <td><code>CONVERT_TO</code></td>
                        <td><strong>44</strong></td>
                        <td>4.5%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-success">Transform</span></td>
                    </tr>
                    <tr>
                        <td><code>COMPARE</code></td>
                        <td><strong>30</strong></td>
                        <td>3.1%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-warning">Validation</span></td>
                    </tr>
                    <tr>
                        <td><code>VALIDATION</code></td>
                        <td><strong>28</strong></td>
                        <td>2.9%</td>
                        <td><span class="badge badge-warning">SERVER</span></td>
                        <td><span class="badge badge-warning">Validation</span></td>
                    </tr>
                    <tr>
                        <td><code>MAKE_DISABLED</code></td>
                        <td><strong>27</strong></td>
                        <td>2.8%</td>
                        <td><span class="badge badge-info">CLIENT</span></td>
                        <td><span class="badge badge-danger">Visibility</span></td>
                    </tr>
                    <tr>
                        <td><code>MAKE_ENABLED</code></td>
                        <td><strong>24</strong></td>
                        <td>2.5%</td>
                        <td><span class="badge badge-info">CLIENT</span></td>
                        <td><span class="badge badge-danger">Visibility</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Expression Functions Deep Dive -->
        <div class="section">
            <h2>üîß Expression Functions Analysis</h2>

            <p>The EXECUTE rules use a JavaScript-like expression syntax with custom functions. Here's the actual usage from production:</p>

            <h3>Function Usage Frequency (from 128 EXECUTE rules)</h3>
            <div class="func-grid">
                <div class="func-card">
                    <span class="func-name">vo()</span>
                    <span class="func-count">304 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">minvi()</span>
                    <span class="func-count">74 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">mvi()</span>
                    <span class="func-count">58 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">cf()</span>
                    <span class="func-count">48 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">mm()</span>
                    <span class="func-count">38 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">ctfd()</span>
                    <span class="func-count">37 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">mnm()</span>
                    <span class="func-count">35 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">rffd()</span>
                    <span class="func-count">25 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">dis()</span>
                    <span class="func-count">14 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">en()</span>
                    <span class="func-count">2 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">adderr()</span>
                    <span class="func-count">2 uses</span>
                </div>
                <div class="func-card">
                    <span class="func-name">remerr()</span>
                    <span class="func-count">2 uses</span>
                </div>
            </div>

            <h3>Function Reference Table</h3>
            <table>
                <thead>
                    <tr>
                        <th>Function</th>
                        <th>Full Name</th>
                        <th>Purpose</th>
                        <th>Syntax</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>vo(id)</code></td>
                        <td>valOf</td>
                        <td>Get field value by variable name</td>
                        <td><code>vo("_fieldName_")</code></td>
                    </tr>
                    <tr>
                        <td><code>mvi()</code></td>
                        <td>makeVisible</td>
                        <td>Make fields visible if condition true</td>
                        <td><code>mvi(condition, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>minvi()</code></td>
                        <td>makeInvisible</td>
                        <td>Make fields invisible if condition true</td>
                        <td><code>minvi(condition, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>mm()</code></td>
                        <td>makeMandatory</td>
                        <td>Make fields mandatory if condition true</td>
                        <td><code>mm(condition, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>mnm()</code></td>
                        <td>makeNonMandatory</td>
                        <td>Make fields non-mandatory if condition true</td>
                        <td><code>mnm(condition, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>ctfd()</code></td>
                        <td>copyToFillData</td>
                        <td>Copy value to fields if condition true</td>
                        <td><code>ctfd(condition, srcValue, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>cf()</code></td>
                        <td>clearField</td>
                        <td>Clear field values if condition true</td>
                        <td><code>cf(condition, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>dis()</code></td>
                        <td>disable</td>
                        <td>Disable fields if condition true</td>
                        <td><code>dis(condition, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>en()</code></td>
                        <td>enable</td>
                        <td>Enable fields if condition true</td>
                        <td><code>en(condition, destIds...)</code></td>
                    </tr>
                    <tr>
                        <td><code>adderr()</code></td>
                        <td>addError</td>
                        <td>Add error message to fields</td>
                        <td><code>adderr(condition, message, destIds...)</code></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Real Expression Examples -->
        <div class="section">
            <h2>üí° Real Expression Examples from Production</h2>

            <div class="rule-example">
                <div class="rule-example-header">
                    <span class="rule-example-title">Example 1: Visibility + Mandatory Toggle</span>
                    <span class="badge badge-primary">Combined Logic</span>
                </div>
                <p><strong>Business Logic:</strong> When checkbox is checked (X), show outlet panels and make fields mandatory. When unchecked, hide and remove mandatory.</p>
                <pre><span class="function">mvi</span>(<span class="function">vo</span>(<span class="string">"_checkBox42_"</span>)==<span class="string">"X"</span>,
    <span class="string">"_outletandlicencedetailspanel_"</span>,
    <span class="string">"_outletPanel_"</span>,
    <span class="string">"_licenseIndividualEstablisment_"</span>,
    <span class="string">"_areyouaGroupowner_"</span>);

<span class="function">minvi</span>(<span class="function">vo</span>(<span class="string">"_checkBox42_"</span>)!=<span class="string">"X"</span>,
    <span class="string">"_outletandlicencedetailspanel_"</span>,
    <span class="string">"_outletPanel_"</span>,
    <span class="string">"_licenseIndividualEstablisment_"</span>,
    <span class="string">"_areyouaGroupowner_"</span>);

<span class="function">mm</span>(<span class="function">vo</span>(<span class="string">"_checkBox42_"</span>)==<span class="string">"X"</span>,
    <span class="string">"_licenseIndividualEstablisment_"</span>,
    <span class="string">"_areyouaGroupowner_"</span>);

<span class="function">mnm</span>(<span class="function">vo</span>(<span class="string">"_checkBox42_"</span>)!=<span class="string">"X"</span>,
    <span class="string">"_licenseIndividualEstablisment_"</span>,
    <span class="string">"_areyouaGroupowner_"</span>);</pre>
            </div>

            <div class="rule-example">
                <div class="rule-example-header">
                    <span class="rule-example-title">Example 2: Conditional Copy with Status Update</span>
                    <span class="badge badge-success">Data Flow</span>
                </div>
                <p><strong>Business Logic:</strong> If outlet code exists, set member type to "Existing" and auto-sync the field.</p>
                <pre><span class="function">ctfd</span>(<span class="function">vo</span>(<span class="string">"_outletCode_"</span>)!=<span class="string">""</span>,
    <span class="string">"Existing"</span>,
    <span class="string">"_groupMemberType_"</span>);

<span class="function">asdff</span>(<span class="keyword">true</span>, <span class="string">"_groupMemberType_"</span>);</pre>
            </div>

            <div class="rule-example">
                <div class="rule-example-header">
                    <span class="rule-example-title">Example 3: Complex Conditional with AND Logic</span>
                    <span class="badge badge-warning">Complex Logic</span>
                </div>
                <p><strong>Business Logic:</strong> Show specific fields only when Individual type AND not a group owner.</p>
                <pre><span class="function">mvi</span>(<span class="function">vo</span>(<span class="string">"_licenseIndividualEstablisment_"</span>) == <span class="string">"Individual"</span>
    <span class="keyword">and</span> <span class="function">vo</span>(<span class="string">"_areyouaGroupowner_"</span>) == <span class="string">"No"</span>,
    <span class="string">"_areyouaThelicensee_"</span>,
    <span class="string">"_whoisaThebeneficiary_"</span>);

<span class="function">mm</span>(<span class="function">vo</span>(<span class="string">"_licenseIndividualEstablisment_"</span>) == <span class="string">"Individual"</span>
    <span class="keyword">and</span> <span class="function">vo</span>(<span class="string">"_areyouaGroupowner_"</span>) == <span class="string">"No"</span>,
    <span class="string">"_areyouaThelicensee_"</span>,
    <span class="string">"_whoisaThebeneficiary_"</span>);</pre>
            </div>

            <div class="rule-example">
                <div class="rule-example-header">
                    <span class="rule-example-title">Example 4: Clear and Copy Conditional</span>
                    <span class="badge badge-info">Multi-Action</span>
                </div>
                <p><strong>Business Logic:</strong> Clear field if not "Group", otherwise copy email from another field.</p>
                <pre><span class="function">cf</span>(<span class="function">vo</span>(<span class="string">"_invididualorgroup_"</span>) != <span class="string">"Group"</span>,
    <span class="string">"_extra001_"</span>);

<span class="function">ctfd</span>(<span class="function">vo</span>(<span class="string">"_invididualorgroup_"</span>) == <span class="string">"Group"</span>,
    <span class="function">vo</span>(<span class="string">"_asmEmailid_"</span>),
    <span class="string">"_extra001_"</span>);

<span class="function">asdff</span>(<span class="keyword">true</span>, <span class="string">"_extra001_"</span>);</pre>
            </div>

            <div class="rule-example">
                <div class="rule-example-header">
                    <span class="rule-example-title">Example 5: Event-Triggered Rule</span>
                    <span class="badge badge-danger">Event Handler</span>
                </div>
                <p><strong>Business Logic:</strong> On field change, clear multiple related fields.</p>
                <pre><span class="function">on</span>(<span class="string">"change"</span>) <span class="keyword">and</span> (
    <span class="function">cf</span>(<span class="keyword">true</span>,
        <span class="string">"_copyofPanotherBeneficiary_"</span>,
        <span class="string">"_copyofPanholdernameotherBeneficiary_"</span>,
        <span class="string">"_copyofIFSCotherBeneficiary_"</span>,
        <span class="string">"_copyofaccountnumberotherBeneficiary_"</span>
    )
);</pre>
            </div>
        </div>

        <!-- Rule JSON Structure -->
        <div class="section">
            <h2>üìã Complete Rule JSON Structures</h2>

            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <div class="icon icon-primary">‚ö°</div>
                        <h3>EXECUTE Rule Structure</h3>
                    </div>
                    <pre>{
  <span class="string">"id"</span>: <span class="number">101320</span>,
  <span class="string">"actionType"</span>: <span class="string">"EXECUTE"</span>,
  <span class="string">"processingType"</span>: <span class="string">"CLIENT"</span>,
  <span class="string">"sourceIds"</span>: [<span class="number">238433</span>],
  <span class="string">"destinationIds"</span>: [],
  <span class="string">"conditionalValues"</span>: [
    <span class="string">"mvi(vo(\"_field_\")==\"X\",\"_dest_\")..."</span>
  ],
  <span class="string">"condition"</span>: <span class="string">"IN"</span>,
  <span class="string">"conditionValueType"</span>: <span class="string">"EXPR"</span>,
  <span class="string">"executeOnFill"</span>: <span class="keyword">true</span>,
  <span class="string">"executeOnRead"</span>: <span class="keyword">false</span>
}</pre>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="icon icon-danger">üëÅÔ∏è</div>
                        <h3>MAKE_INVISIBLE Rule Structure</h3>
                    </div>
                    <pre>{
  <span class="string">"id"</span>: <span class="number">101312</span>,
  <span class="string">"actionType"</span>: <span class="string">"MAKE_INVISIBLE"</span>,
  <span class="string">"processingType"</span>: <span class="string">"CLIENT"</span>,
  <span class="string">"sourceIds"</span>: [<span class="number">238408</span>],
  <span class="string">"destinationIds"</span>: [<span class="number">238470</span>, <span class="number">238478</span>, ...],
  <span class="string">"conditionalValues"</span>: [<span class="string">"INVISIBLE"</span>],
  <span class="string">"condition"</span>: <span class="string">"NOT_IN"</span>,
  <span class="string">"conditionValueType"</span>: <span class="string">"TEXT"</span>,
  <span class="string">"executeOnFill"</span>: <span class="keyword">true</span>
}</pre>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="icon icon-info">üîç</div>
                        <h3>OCR Rule Structure</h3>
                    </div>
                    <pre>{
  <span class="string">"id"</span>: <span class="number">101419</span>,
  <span class="string">"actionType"</span>: <span class="string">"OCR"</span>,
  <span class="string">"sourceType"</span>: <span class="string">"PAN_IMAGE"</span>,
  <span class="string">"processingType"</span>: <span class="string">"SERVER"</span>,
  <span class="string">"sourceIds"</span>: [<span class="number">238472</span>],
  <span class="string">"destinationIds"</span>: [<span class="number">238473</span>],
  <span class="string">"postTriggerRuleIds"</span>: [<span class="number">101420</span>],
  <span class="string">"onStatusFail"</span>: <span class="string">"CONTINUE"</span>,
  <span class="string">"executeOnFill"</span>: <span class="keyword">true</span>
}</pre>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="icon icon-success">üìã</div>
                        <h3>COPY_TO Rule Structure</h3>
                    </div>
                    <pre>{
  <span class="string">"id"</span>: <span class="number">101319</span>,
  <span class="string">"actionType"</span>: <span class="string">"COPY_TO"</span>,
  <span class="string">"sourceType"</span>: <span class="string">"FORM_FILL_METADATA"</span>,
  <span class="string">"processingType"</span>: <span class="string">"SERVER"</span>,
  <span class="string">"sourceIds"</span>: [<span class="number">238432</span>],
  <span class="string">"destinationIds"</span>: [<span class="number">238433</span>],
  <span class="string">"delimiter"</span>: <span class="string">""</span>,
  <span class="string">"executeOnFill"</span>: <span class="keyword">true</span>
}</pre>
                </div>
            </div>
        </div>

        <!-- Conversion Strategy Update -->
        <div class="section">
            <h2>üöÄ Updated Conversion Strategy</h2>

            <div class="highlight-box">
                <h4>üîë Key Insight: Variable Names vs IDs</h4>
                <p>Production rules use <strong>variable names</strong> (like <code>"_checkBox42_"</code>) in expressions, not numeric IDs.
                This means the conversion system must:</p>
                <ol style="margin-top: 10px;">
                    <li>Generate unique variable names for each field (format: <code>_fieldName_</code>)</li>
                    <li>Build a field name ‚Üí variable name mapping</li>
                    <li>Use variable names in expression generation</li>
                </ol>
            </div>

            <h3>Revised Conversion Pipeline</h3>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="step-icon">üìÑ</div>
                    <div class="step-title">Parse Document</div>
                    <div class="step-desc">Extract fields & logic</div>
                </div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step">
                    <div class="step-icon">üè∑Ô∏è</div>
                    <div class="step-title">Generate Variables</div>
                    <div class="step-desc">Create _fieldName_ vars</div>
                </div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step">
                    <div class="step-icon">üîç</div>
                    <div class="step-title">Classify Rules</div>
                    <div class="step-desc">Pattern matching</div>
                </div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step">
                    <div class="step-icon">ü§ñ</div>
                    <div class="step-title">Generate Expression</div>
                    <div class="step-desc">Template or LLM</div>
                </div>
                <span class="flow-arrow">‚Üí</span>
                <div class="flow-step">
                    <div class="step-icon">üì¶</div>
                    <div class="step-title">Build Rule JSON</div>
                    <div class="step-desc">Complete structure</div>
                </div>
            </div>

            <h3>Conversion Coverage Estimate (Based on Real Data)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Rule Category</th>
                        <th>Count</th>
                        <th>Template %</th>
                        <th>LLM %</th>
                        <th>Complexity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Simple Visibility (MAKE_VISIBLE/INVISIBLE)</td>
                        <td>137</td>
                        <td><span class="badge badge-success">90%</span></td>
                        <td>10%</td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td>Simple Mandatory Rules</td>
                        <td>124</td>
                        <td><span class="badge badge-success">85%</span></td>
                        <td>15%</td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td>Direct Copy Rules</td>
                        <td>217</td>
                        <td><span class="badge badge-success">95%</span></td>
                        <td>5%</td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td>OCR/Verify Rules</td>
                        <td>108</td>
                        <td><span class="badge badge-success">100%</span></td>
                        <td>0%</td>
                        <td>Low (Fixed patterns)</td>
                    </tr>
                    <tr>
                        <td>Expression Rules (EXECUTE)</td>
                        <td>128</td>
                        <td><span class="badge badge-warning">40%</span></td>
                        <td>60%</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>External Dropdown</td>
                        <td>58</td>
                        <td><span class="badge badge-success">80%</span></td>
                        <td>20%</td>
                        <td>Medium</td>
                    </tr>
                    <tr style="background: #f0fdf4;">
                        <td><strong>TOTAL</strong></td>
                        <td><strong>772</strong></td>
                        <td><strong>~75%</strong></td>
                        <td><strong>~25%</strong></td>
                        <td>-</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- OCR/Verification Rules -->
        <div class="section">
            <h2>üîç OCR & Verification Rules</h2>

            <p>OCR and verification rules follow fixed patterns based on source type:</p>

            <h3>Source Types and Destination Fields</h3>
            <table>
                <thead>
                    <tr>
                        <th>Source Type</th>
                        <th>Action</th>
                        <th>Typical Destinations</th>
                        <th>Count</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>PAN_IMAGE</code></td>
                        <td>OCR</td>
                        <td>PAN Number, Name, Type</td>
                        <td>21</td>
                    </tr>
                    <tr>
                        <td><code>PAN_NUMBER</code></td>
                        <td>VERIFY</td>
                        <td>Validation Status, Name Match</td>
                        <td>21</td>
                    </tr>
                    <tr>
                        <td><code>BANK_ACCOUNT_NUMBER</code></td>
                        <td>VERIFY</td>
                        <td>Account Status, IFSC, Bank Name</td>
                        <td>24</td>
                    </tr>
                    <tr>
                        <td><code>GSTIN_IMAGE</code></td>
                        <td>OCR</td>
                        <td>GSTIN Number, Trade Name</td>
                        <td>9</td>
                    </tr>
                    <tr>
                        <td><code>GSTIN</code></td>
                        <td>VERIFY</td>
                        <td>GST Status, Legal Name</td>
                        <td>9</td>
                    </tr>
                    <tr>
                        <td><code>CHEQUEE</code></td>
                        <td>OCR</td>
                        <td>Account Number, IFSC, Bank Name</td>
                        <td>24</td>
                    </tr>
                    <tr>
                        <td><code>NAMES</code></td>
                        <td>COMPARE</td>
                        <td>Match Score, Status</td>
                        <td>30</td>
                    </tr>
                </tbody>
            </table>

            <div class="highlight-box">
                <h4>‚úÖ Good News: OCR/Verify Rules are 100% Template-able</h4>
                <p>These rules follow strict patterns and don't require LLM conversion. We just need to map:</p>
                <ul style="margin-top: 10px;">
                    <li>Document type ‚Üí Source type (e.g., "Upload PAN" ‚Üí PAN_IMAGE)</li>
                    <li>Expected outputs ‚Üí Destination field variable names</li>
                    <li>Post-trigger rules (e.g., OCR ‚Üí VERIFY chain)</li>
                </ul>
            </div>
        </div>

        <!-- Implementation Recommendations -->
        <div class="section">
            <h2>üìù Implementation Recommendations</h2>

            <div class="grid-2">
                <div class="card">
                    <div class="card-header">
                        <div class="icon icon-success">‚úÖ</div>
                        <h3>Template Engine Requirements</h3>
                    </div>
                    <ul class="checklist">
                        <li>‚úì Variable name generator (<code>_fieldName_</code> format)</li>
                        <li>‚úì Field name ‚Üí variable name mapping</li>
                        <li>‚úì Simple visibility condition templates</li>
                        <li>‚úì Simple mandatory condition templates</li>
                        <li>‚úì OCR rule templates by document type</li>
                        <li>‚úì VERIFY rule templates by validation type</li>
                        <li>‚úì COPY_TO templates for direct copies</li>
                        <li>‚úì EXT_DROP_DOWN templates for lookups</li>
                    </ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="icon icon-primary">ü§ñ</div>
                        <h3>LLM Conversion Requirements</h3>
                    </div>
                    <ul class="checklist">
                        <li>‚úì Complex EXECUTE expression generation</li>
                        <li>‚úì Multi-condition visibility rules</li>
                        <li>‚úì AND/OR combined conditions</li>
                        <li>‚úì Event-triggered rules (on change)</li>
                        <li>‚úì Conditional copy with multiple sources</li>
                        <li>‚úì Clear + Copy combinations</li>
                        <li>‚úì Cross-field dependency resolution</li>
                        <li>‚úì Ambiguous natural language interpretation</li>
                    </ul>
                </div>
            </div>

            <h3>Priority Order for Implementation</h3>
            <ol style="margin: 20px 0 20px 25px;">
                <li><strong>Phase 1:</strong> Variable name generator + field mapping (Foundation)</li>
                <li><strong>Phase 2:</strong> OCR/VERIFY templates (108 rules - 100% automatable)</li>
                <li><strong>Phase 3:</strong> Simple visibility templates (137 rules - 90% automatable)</li>
                <li><strong>Phase 4:</strong> Copy rule templates (217 rules - 95% automatable)</li>
                <li><strong>Phase 5:</strong> LLM integration for EXECUTE expressions (128 rules)</li>
                <li><strong>Phase 6:</strong> Complex rule handling and edge cases</li>
            </ol>
        </div>

        <!-- Cost Analysis Update -->
        <div class="section">
            <h2>üí∞ Revised Cost Analysis</h2>

            <p>Based on actual rule distribution from production data:</p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Approach</th>
                        <th>Template Rules</th>
                        <th>LLM Rules</th>
                        <th>Est. Cost/Doc</th>
                        <th>Accuracy</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Pure LLM (All rules)</td>
                        <td>0</td>
                        <td>~300</td>
                        <td>$3.00 - $5.00</td>
                        <td>85-90%</td>
                    </tr>
                    <tr>
                        <td>Hybrid (Original estimate)</td>
                        <td>210 (70%)</td>
                        <td>90 (30%)</td>
                        <td>$0.50 - $1.00</td>
                        <td>90-95%</td>
                    </tr>
                    <tr style="background: #f0fdf4;">
                        <td><strong>Hybrid (Revised)</strong></td>
                        <td><strong>225 (75%)</strong></td>
                        <td><strong>75 (25%)</strong></td>
                        <td><strong>$0.30 - $0.60</strong></td>
                        <td><strong>93-97%</strong></td>
                    </tr>
                    <tr>
                        <td>Hybrid + Haiku for simple</td>
                        <td>225 (75%)</td>
                        <td>75 (Haiku)</td>
                        <td>$0.10 - $0.20</td>
                        <td>90-95%</td>
                    </tr>
                </tbody>
            </table>

            <div class="highlight-box">
                <h4>üí° Key Optimization: OCR/VERIFY rules are Free</h4>
                <p>108 rules (OCR + VERIFY) follow fixed patterns and require zero LLM calls.
                This alone saves ~$0.30 per document compared to the original estimate.</p>
            </div>
        </div>

        <!-- Summary -->
        <div class="section">
            <h2>üìä Summary</h2>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">75%</div>
                    <div class="stat-label">Template-Automatable</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">~$0.40</div>
                    <div class="stat-label">Avg Cost/Document</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">95%</div>
                    <div class="stat-label">Expected Accuracy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">85%</div>
                    <div class="stat-label">Cost Savings vs LLM</div>
                </div>
            </div>

            <div class="highlight-box">
                <h4>üéØ Final Recommendation</h4>
                <p>The analysis of 979 production rules confirms the hybrid approach is viable and cost-effective. Key findings:</p>
                <ol style="margin-top: 15px;">
                    <li><strong>Variable names are critical</strong> - Rules use <code>_fieldName_</code> format, not numeric IDs</li>
                    <li><strong>EXECUTE rules are the challenge</strong> - Complex expressions need LLM, but patterns exist</li>
                    <li><strong>OCR/VERIFY are standardized</strong> - 100% template coverage possible</li>
                    <li><strong>75% template coverage is achievable</strong> - Higher than initial 70% estimate</li>
                    <li><strong>Expression syntax is well-defined</strong> - vo(), mvi(), minvi(), mm(), mnm(), ctfd(), cf() cover 90%+ of cases</li>
                </ol>
            </div>
        </div>

        <footer style="text-align: center; padding: 40px; color: var(--text-muted);">
            <p><strong>Document Parser - Rules Analysis V2</strong></p>
            <p>Based on analysis of 979 rules from 5 production JSON schemas</p>
            <p>January 2026</p>
        </footer>
    </div>
</body>
</html>
